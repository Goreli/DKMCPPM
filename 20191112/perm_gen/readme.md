# Generic Permutation Generator
<p align="center">Harmonious Discord of the Seemingly Distinct</p>

___

# Table of Contents
1. [Introduction](#introduction)
2. [Content Overview](#content-overview)
3. [Command Line Interface](#command-line-interface)
4. [Build Notes](#build-notes)
5. [Roadmap](#roadmap)
6. [Links](#links)

## Introduction

This directory contains C++ source code written to address the String Permutation Generator challenge discussed at the Melbourne C++ Meetup Olympiad on 12/Nov/2019. A reusable C++ template header file has been developed that allows to calculate permutations of arbitrary trivial type sequences. Also, two applications have been developed that specialise the permutation engine specifically for the purpose of string permutation and provide command line interfaces to drive their respective functions.

Application **str-perm-gen-b** has been designed to dry run the permutation engine for benchmarking purposes. Given an input string the appication prints summary level information about how many permutations have been generated, how many test cycles have been executed and what the average execution time per test cycle is.

Application **str-perm-gen** prints actual permutations of the input string specified. It may take long time to print all possible permutations of a long input string. The application accepts a command line argument that limits the number of permutations to generate in order to keep the execution time below a reasonable limit. Also, in cases where it takes long time to print the output on the screen the users should be able to impove performance of the program by redirecting the standard output to a disk file. 

The following image shows example output generated by the applications. The commands executed were:
 * ./str-perm-gen-b "Hello World" 10
 * ./str-perm-gen Car

![alt text](data/example.png "Example output of str-perm-gen-b and str-perm-gen.")

## Content Overview

The project source code consists of the following components located in the [perm_gen](https://github.com/Goreli/DKMCPPM/tree/master/20191112/perm_gen) directory:
 * perm_gen_base.hpp - declares a template class called PermutationGeneratorBase. The class template provides a generic permutation engine that can process sequences of arbitrary trivial types. Populate *std::vector<T>* with the input sequence and pass it into the *generate(....)* function to start generating permutations of the sequence. Every time the engine generates a new permutation it passes the permutation into the *process_(....)* pure virtual function. Derived classes are responsible for utilising (printing, updating application variables etc) the permutations by overriding the *process_(....)* pure virtual function;
 * perm_gen_base.inl - this module defines the PermutationGeneratorBase template class and is included as a compilation unit at the end of perm_gen_base.hpp. Applications link the permutation engine in by including the perm_gen_base.hpp header file;
 * str_perm_gen_b.cpp - this is the main entry module of the str-perm-gen-b application. It implements a command line interface to the permutation engine adapted to the char data type. The purpose is to benchmark performance of the string permutation process. The command line interface is very simple and has been implemented inside this module;
 * str_perm_gen.cpp - the main entry module of the str-perm-gen application. It has its own command line interface to the permutation engine adapted to the char data type. The purpose is to provide a command line tool that efficiently delivers string permutations. The following two modules implement the command line interface for this application;
 * str_perm_gen_cli.hpp - declaration of a command line parser class for the str-perm-gen application;
 * str_perm_gen_cli.cpp - definition of the command line parser class for the str-perm-gen application;
 * time-hello-world.sh - Bash script that times the following command: ./str-perm-gen "Hello World" > hello_world.txt
  
## Command Line Interface
 
### CLI for str-perm-gen-b
str-perm-gen-b [input_string] [number_of_test_cycles]
 * input_string - the string to generate permutations of;
 * number_of_test_cycles - the number of test cycles to execute before calculating the average duration per cycle.

If there are no command line arguments specified then the application prints its usage instructions.

Example:
./str-perm-gen-b "Hello World" 10

In this example the application executes 10 cycles each generating 39,916,800 permutations. It records the total execution time, divides it by the number of cycles (which is 10) to arrive at the average duration per cycle and prints the result on the screen. Despite the fact that the number of permutations to deal with is huge the duration of the process is noticably short as there is no large volume of information to print.

### CLI for str-perm-gen
str-perm-gen [input_string] [options]

The input_string parameter specifies the string to print permutations of. The following options are supported:
 * **+number** - start printing at the specified permutation number. The permutation number is a 1 based number, not a 0 based index. If this parameter is not specified then the application generates and prints all possible permutations;
 * **-c count**  - the count of permutations to print;
 * **-e regex**  - excluding regex. Don't print permutations that match the regular expression;
 * **-i regex**  - including regex. Only print permutations that match the regular expression;
 * **-n** - print permutation numbers (1 based numbers, not 0 based indices);
 * **-o path** - output file path.

The **-e** and **-i** options are mutually exclusive. They provide light-weight support for regular expression based filtering and are expected to comply with the ECMAScript standard. The specification of the ECMAScript standard can be found here: http://www.cplusplus.com/reference/regex/ECMAScript/.

Note that not all regular expressions can be used interchangeably on Windows and Linux command lines. This is because the different platforms use different escape characters and, in general, different command line syntax rules. This may cause unexpected behaviour of regular expressions when migrated to a different platform. Part of the roadmap for this application is to develop a text file based regex filter in order to offer platform independent interpretation of regex expressions as well as an advanced filtering facility.

If there are no command line arguments specified then the application prints its usage instructions.

 #### Example 1
./str-perm-gen Car

In this example the application prints all the 6 possible permutations of the string Car.

#### Example 2
./str-perm-gen Car +3

The application skips the first two permutations. It starts printing beginning with the 3rd permutation and prints 4 permutations in total.

#### Example 3
./str-perm-gen Car +3 -c 2

The application skips the first two permutations. It starts printing beginning with the 3rd permutation and prints 2 permutations in total.

#### Example 4
./str-perm-gen Car +3 -c 2 -n 

Same as the previous example. The difference is the application prints permutation numbers at the start of each line.

#### Example 5
./str-perm-gen "Hi there!" +1300 -c 100 -n > permuted_greetings.txt

The application skips the first 1,299 permutations and starts printing beginning with permutation #1,300. It only prints 100 out of 362,880 possible permutations. Permutation numbers are printed at the start of each line. The output is redirected to the permuted_greetings.txt file, so nothing is actually displayed on the screen and all the output is saved in the disk file. Note that the redirection of standard output to the disk file improves performance of the process.

#### Example 6
./str-perm-gen "Hi there!" +1300 -c 100 -n -o permuted_greetings.txt

Similar to example 5. Note the -o option used to specify the output file.

#### Example 7
str-perm-gen "Hello World" -n -i " Hello$"

The inclusion type regex is used. The application only prints permutations that end with " Hello". Permutation numbers are printed at the start of each line.

## Build Notes

The project provides build artefacts for two platforms. There is a Makefile in the [perm_gen](https://github.com/Goreli/DKMCPPM/tree/master/20191112/perm_gen) directory that compiles the source code on the Linux platform using the clang++ compiler. There are also Visual Studio 2019 project files in the [vs_projects](https://github.com/Goreli/DKMCPPM/tree/master/20191112/perm_gen/vs_projects) subdirectory.

Navigate to the [perm_gen](https://github.com/Goreli/DKMCPPM/tree/master/20191112/perm_gen) directory and type "make [Enter]" to build binary executables on the Linux platform. Type "make test [Enter]" and "make benchmark [Enter]" to test-run the applications. Here is a summary of the Linux Makefile targets:

 * make all [Enter] (same as make [Enter]) - build both applications in the project directory;
 * make str-perm-gen-b [Enter] - build str-perm-gen-b;
 * make str-perm-gen [Enter] - build str-perm-gen;
 * make clean [Enter] - remove both applications from the project directory;
 * make test [Enter] - prints permutations of the string "Car";
 * make benchmark [Enter] - benchmarks the permutation engine using the string "Hello World";
 * make release [Enter] - builds both applications and copies them to the ../../elf/release directory.

To build Windows executables open the dkmccpm.sln solution file located in the root directory of the repository and navigate to this project in the Solution Explorer panel. The actual binaries are created in ../../x64. Here is the project configuration log:
1. Set the language standard to c++17;
2. Let the c++ compiler know the locations of include areas: ../..
3. Switch precompiled headers off;
4. Set the Command Line Arguments in the Debugging section to "Hello World!". Make sure to include the double quoting marks.

## Roadmap

1. Develop a text file based regex filter in order to offer platform independent interpretation of regex expressions as well as an advanced filtering facility. In this application performance bottleneck is caused by the output stream, so it should be possible to manage the regex overhead by taking a multithreading based approach;
2. Explore ways to use concurrency or async (or plain C io) to boost performance of the output stream (refer https://stackoverflow.com/questions/21126950/asynchronously-writing-to-a-file-in-c-unix).

## Links

1. Melbourne C++ Meetup on meetup.com:
	https://www.meetup.com/MelbourneCpp/
2. Melbourne C++ Meetup on GitHub.com:
	https://github.com/melbourne-cpp
3. Melbourne C++ Meetup Olympiad materials on GitHub.com: 
	https://github.com/melbourne-cpp/olympiad
4. The Olympiad Wiki page on GitHub.com: 
	https://github.com/melbourne-cpp/olympiad/wiki
5. This repository on GitHub.com:
	https://github.com/Goreli/DKMCPPM
6. This solution on GitHub.com:
	https://github.com/Goreli/DKMCPPM/tree/master/20191112/perm_gen
